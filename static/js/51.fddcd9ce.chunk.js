(this["webpackJsonpfront-js"]=this["webpackJsonpfront-js"]||[]).push([[51],{1316:function(e,t,a){"use strict";var c=a(12),n=a(5),r=a(0),s=a(3),i=a(21),o=a(2),l=a(16),u=a.n(l),b=a(57),j=a(1320),p=a(834),d=a(112),O=a(621),f=a(168),v=a(26),x=a(1),h=a(6),m=a(127),g=a(649),k=a(663),w=(a(735),a(838)),N=a(199),y=a(654),S=a(15),_=a(9),P=h.a.pools,C=h.a.poolKeys,D=h.a.ALL_FEE,L=h.a.defaultSlippage,F=h.a.stablePool;t.a=function(e){var t=Object(b.d)((function(){return m.a.network})),a=Object(b.d)((function(){return m.a.system})),l=Object(b.d)((function(){return m.a.pool})),h=Object(o.useState)(function(){var e={};return C.map((function(t){e[t]=""})),e}()),I=Object(i.a)(h,2),T=I[0],Y=I[1],B=Object(o.useState)(!1),U=Object(i.a)(B,2),V=U[0],q=U[1],A=Object(o.useState)(!0),E=Object(i.a)(A,2),H=E[0],J=E[1],z=Object(o.useState)(!1),K=Object(i.a)(z,2),M=K[0],G=K[1],Q=Object(o.useState)("--"),R=Object(i.a)(Q,2),W=R[0],X=R[1],Z=Object(o.useState)("--"),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ae=Object(o.useState)(!1),ce=Object(i.a)(ae,2),ne=ce[0],re=ce[1],se=Object(o.useState)(!1),ie=Object(i.a)(se,2),oe=ie[0],le=ie[1],ue=Object(o.useState)(!1),be=Object(i.a)(ue,2),je=be[0],pe=be[1],de=null;Object(o.useEffect)(Object(s.a)(Object(r.a)().mark((function e(){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([ke(T),ve()]);case 2:ne&&me(T);case 3:case"end":return e.stop()}}),e)}))),[T]);var Oe=function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,M){e.next=5;break}if(!me(t)){e.next=5;break}return e.abrupt("return");case 5:if(!M){e.next=7;break}return e.abrupt("return");case 7:if(!Object(x.a)(W).abs().gt(10)){e.next=9;break}return e.abrupt("return",le(!0));case 9:return e.next=11,fe(t);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var t=Object(s.a)(Object(r.a)().mark((function t(c){var s,i,o,u,b,j,p,d,O,f,v,h,m,g,k,w,N;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,s=[],e.onSubmit&&e.onSubmit(),C.map((function(e){s.push(Object(n.a)(Object(n.a)({},l.poolData[e]),{},{inputValue:c[e]?Object(x.Y)(c[e]).times(P[e].precision):Object(x.a)(0)}))})),i=0;case 5:if(!(i<s.length)){t.next=19;break}if(o=s[i],u=o.allowance,b=void 0===u?Object(x.a)(0):u,j=o.inputValue,p=o.token,d=o.symbol,O=o.approveStatus,f=o.id,!Object(x.a)(b).lt(j)||O){t.next=16;break}return t.next=10,a.approveToken(p,F,{title:"deposit.approve_token",obj:{value:d},continuous:!0},[["pool/getBalanceInfo"]]);case 10:if(!t.sent){t.next=15;break}l.poolData[f].approveStatus=2,t.next=16;break;case 15:return t.abrupt("return");case 16:i++,t.next=5;break;case 19:if(v=s.sort((function(e,t){return e.index-t.index})),h=v.length,m=v.map((function(e){return e.inputValue._toIntegerDown()._toHex()}))||[],g=null,!l.lpTotalSupply.lte(0)){t.next=26;break}return t.next=26,l.getUserLp();case 26:if(!l.lpTotalSupply.lte(0)){t.next=30;break}g=Object(x.a)(1),t.next=36;break;case 30:return t.next=32,Object(S.d)(m);case 32:if((k=t.sent).success){t.next=35;break}return t.abrupt("return");case 35:g=k.value;case 36:return g=g.times(Object(x.a)(1).minus(Object(x.a)(D).times(h).div(Object(x.a)(4).times(h-1)).div(1e10))),w=g.times(1-L)._toFixed(0,1),N={title:"actions.addLiq",obj:{detail:Object(x.z)(c)}},t.next=41,a.addLiquidity(m,w,N,[["pool/updateCurrencyData"]]);case 41:t.sent&&Se(),t.next=48;break;case 45:t.prev=45,t.t0=t.catch(0),console.log("deposit err: ",t.t0);case 48:case"end":return t.stop()}}),t,null,[[0,45]])})));return function(e){return t.apply(this,arguments)}}(),ve=function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a,c,n,s,i,o,u;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],T)c=P[a],n=c.index,s=c.precision,i=T[a].replace(/,/g,""),t[n]=Object(x.a)(i).isNaN()?0:Object(x.a)(i).times(s)._toIntegerDown()._toHex();if(o=null,!l.lpTotalSupply.lte(0)){e.next=6;break}return e.next=6,l.getUserLp();case 6:if(!l.lpTotalSupply.lte(0)){e.next=10;break}o=Object(x.a)(1),e.next=16;break;case 10:return e.next=12,Object(S.d)(t);case 12:if((u=e.sent).success){e.next=15;break}return e.abrupt("return");case 15:o=u.value.div(1e18);case 16:te(o);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=Object(s.a)(Object(r.a)().mark((function e(){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([l.getSwapBalance(),l.getVirtualPrice(),l.getVolData()]);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([l.getUserLp(),l.getBalanceInfo()]);case 2:a={},C.map((function(e){var t=l.poolData[e],c=t.precision,n=t.balance,r=t.decimal;a[e]=Object(x.c)(Object(x.a)(n).div(c)._toFixed(r,1))})),Y(a),!ne&&re(!0),de||(de=setInterval(Object(s.a)(Object(r.a)().mark((function e(){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:xe(),l.getUserLp();case 2:case"end":return e.stop()}}),e)}))),t.defaultIntervalSec));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(o.useEffect)(Object(s.a)(Object(r.a)().mark((function e(){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([he(),xe()]);case 2:return e.abrupt("return",(function(){clearInterval(de)}));case 3:case"end":return e.stop()}}),e)}))),[t.defaultAccount]);var me=function(e){var t=Object.keys(e),a=t.length;if(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.keys(e),a=t.filter((function(t){return Object(x.Y)(e[t]).eq(0)||!e[t]}));return t.length===a.length}(e))return G(u.a.get("error.e1")),!0;for(var c=0;c<a;c++){var n=t[c],r=e[n];if(!r&&(V||H))return G(u.a.get("error.e1")),!0;var s=l.poolData[n],i=s.balance,o=s.precision,b=s.symbol;if(Object(x.a)(i).div(o).lt(Object(x.Y)(r)))return G(u.a.get("error.e2",{token:b})),!0}return G(!1),!1},ge=function(e){pe(e.target.checked)},ke=function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.calcInclPrice(t);case 2:a=e.sent,X(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(e,t){var a=t,c={};c[e]=Object(x.c)(String(a).replace(/,/g,""));var n=l.poolData[e],r=(n.precision,n.swapBalance),s=(n.balance,Object(x.Y)(a).div(r).isNaN()?Object(x.a)(0):Object(x.Y)(a).div(r));C.filter((function(t){return t!==e})).map((function(e){var t=l.poolData[e],a=t.balance,n=void 0===a?Object(x.a)(0):a,r=t.swapBalance,i=t.precision,o=t.decimal;c[e]=Object(x.c)(s.times(r)._toFixed(o,1)),n.div(i).lt(Object(x.Y)(c[e]))&&(c[e]=Object(x.c)(n.div(i)._toFixed(o,1)))})),Y(c)},Ne=function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{a=t.target.checked,q(a),H&&J(!a),a&&we(C[0],T[C[0]])}catch(c){console.log(c)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ye=function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){var a,c;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{a=t.target.checked,J(a),V&&q(!a),c={},C.map((function(e){var t=l.poolData[e],a=t.balance,n=t.precision,r=t.decimal;c[e]=Object(x.a)(a).isNaN()?0:Object(x.c)(a.div(n)._toFixed(r,1))})),Y(c)}catch(n){console.log(n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(){pe(!1),le(!1)};return Object(_.jsx)(b.a,{children:function(){return Object(_.jsxs)("div",{className:"pool-deposit",children:[e.isSinglePage?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(g.a,{routeName:"3pool/deposit",mountedActions:he,instantActions:xe}),Object(_.jsx)(k.a,{title:"3pool "+u.a.get("banner.title_deposit"),desc:u.a.get("banner.desc_deposit")}),Object(_.jsx)(y.a,{})]}):null,t.isConnected?Object(_.jsx)("div",{className:e.isSinglePage?"window white":"window-for-tabs-pane",children:Object(_.jsxs)("div",{className:"add-liq",children:[Object(_.jsxs)("fieldset",{className:"currencies",children:[Object(_.jsx)("legend",{children:u.a.get("deposit.currencies")}),Object(_.jsx)("ul",{children:C.map((function(e){var t=l.poolData[e],a=t.symbol,r=void 0===a?"":a,s=t.balance,i=void 0===s?"--":s,o=t.precision,b=t.decimal;return i=Object(x.a)(i).div(o),Object(_.jsxs)("li",{children:[Object(_.jsxs)("div",{className:"cur-label",children:[Object(_.jsxs)("span",{className:"icon",children:[Object(_.jsx)("img",{src:v.a[e]?v.a[e]:f.default,alt:"",className:"token-logo"})," ",r]}),Object(_.jsx)("span",{className:"token-max c-purple",onClick:function(){!function(e,t,a){if(!Object(x.a)(t).isNaN()){var r=Object(x.a)(t)._toFixed(a,1);Y(Object(n.a)(Object(n.a)({},T),{},Object(c.a)({},e,Object(x.c)(r)))),V&&we(e,r)}}(e,i,b)},children:u.a.get("deposit.token_max",{balance:Object(x.t)(i)})})]}),Object(_.jsx)("div",{className:"cur-input",children:Object(_.jsx)(j.a,{placeholder:"0",value:T[e],onChange:function(t){return function(e,t){H&&J(!1);var a=P[t].decimal,r=Object(x.P)((""+e.target.value).replace(/,/g,""),a),s=r.valid,i=r.str;s&&(Y(Object(n.a)(Object(n.a)({},T),{},Object(c.a)({},t,Object(x.c)(i)))),V&&we(t,i))}(t,e)}})})]},e)}))})]}),Object(_.jsxs)("div",{className:"deposit-check",children:[Object(_.jsx)(p.a,{checked:V,onChange:Ne,children:u.a.get("deposit.ch1")}),Object(_.jsx)("br",{}),Object(_.jsx)(p.a,{checked:H,onChange:ye,children:u.a.get("deposit.ch2")})]}),M&&Object(_.jsx)("div",{className:"error-content",children:Object(_.jsx)("div",{className:"red-error error-tip",children:M})}),Object(_.jsx)("div",{className:"sell-submit-wrapper",children:Object(_.jsx)(d.a,{className:"tab-btn",onClick:function(){return Oe(T)},disabled:M,children:u.a.get("deposit.action")})}),Object(x.a)(ee).gt(0)&&Object(_.jsxs)("div",{className:"m-10 swap-detail ml-0 mr-0",children:[Object(_.jsxs)("div",{className:"r1 fs-12",children:[u.a.getHTML("deposit.swap_detail",{value:Object(x.t)(ee,2),symbol:"Old 3pool LP"})," "]}),Object(_.jsx)("div",{className:"r2 fs-12",children:u.a.get("deposit.exchange_rate",{value:Object(x.t)(l.virtualPrice,6),symbol:"Old 3pool LP"})})]}),!Object(x.a)(W).isNaN()&&Object(x.U)(W,!0)]})}):null,Object(_.jsx)(w.a,{className:t.isConnected?null:"window-for-tabs-pane"}),Object(_.jsx)(N.a,{}),Object(_.jsx)(O.a,{title:u.a.get("deposit.high_slippage_title"),visible:oe,closable:!0,icon:null,onCancel:Se,footer:null,width:400,className:"common-modal common-bg slippage-modal",children:Object(_.jsxs)("div",{className:"center",children:[Object(_.jsxs)("div",{className:"common-err-bg",children:[Object(_.jsx)("div",{children:u.a.get("deposit.high_tip1")}),Object(_.jsx)("div",{children:u.a.get("deposit.high_tip2",{value:Object(x.t)(Object(x.a)(W).abs(),3)})})]}),Object(_.jsx)(p.a,{checked:je,onChange:ge,children:u.a.get("deposit.confirm_slippage",{value:Object(x.t)(Object(x.a)(W).abs(),3)})}),Object(_.jsx)("br",{}),Object(_.jsxs)("div",{className:"btns flex",children:[Object(_.jsx)(d.a,{onClick:function(){return le(!1)},type:"primary",children:u.a.get("cancel")}),Object(_.jsx)(d.a,{onClick:function(){return fe(T)},disabled:!je,children:u.a.get("deposit.anyway")})]})]})})]})}})}},1644:function(e,t,a){"use strict";a.r(t);a(2),a(649),a(763),a(741);var c=a(1316),n=a(9);t.default=function(){return Object(n.jsx)("div",{className:"container",children:Object(n.jsx)(c.a,{isSinglePage:!0})})}},763:function(e,t,a){}}]);