(this["webpackJsonpfront-js"]=this["webpackJsonpfront-js"]||[]).push([[44],{1340:function(e,t,n){},1749:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return oe}));var a=n(3),c=(n(1340),n(4)),r=n(17),o=n(0),i=n(2),s=n(14),l=n(20),u=n.n(l),b=n(84),j=n(171),d=n(1),v=n(30),h=n(15),O=n(6),g=n(50),p=n(892),x=(n(902),n(901),n(106)),m=n(1079),f=n.n(m),y=n(865),k=n(875),w=n(10),W=function(e){return e>0&&e<10?"0"+e:e},_=function(e){var t=e.data;if(-1===t)return Object(w.jsx)("p",{className:"countDown",children:"".concat(u.a.get("governance.countdown"),": --").concat(u.a.get("governance.day")," --").concat(u.a.get("governance.hour")," --").concat(u.a.get("governance.minute")," --").concat(u.a.get("governance.second"))});var n=Math.floor(t/864e5),a=t%864e5,c=Math.floor(a/36e5),r=a%36e5,o=Math.floor(r/6e4),i=r%6e4,s=Math.round(i/1e3);return Object(w.jsxs)("p",{className:"countDown",children:[u.a.get("governance.countdown"),":",Object(w.jsx)("span",{children:" ".concat(n).concat(u.a.get("governance.day")," ").concat(W(c)).concat(u.a.get("governance.hour")).concat(W(o)).concat(u.a.get("governance.minute")).concat(W(s)).concat(u.a.get("governance.second"))})]})},S=function(e){var t,n=1e3,c=e.serverTime,l=e.nextTime,j=e.miningWeight,v=e.resetCountDown,h=Object(a.useState)(Object(x.a)(window.navigator).any),O=Object(s.a)(h,1)[0],p=Object(a.useState)(-1),m=Object(s.a)(p,2),W=m[0],S=m[1];Object(a.useEffect)((function(){return I(),function(){clearInterval(t)}}),[c]);var F=Object(a.useRef)(null),N=Object(a.useState)({click:function(e){var t=F.current.getEchartsInstance();0!==e.dataIndex&&t.dispatchAction({type:"downplay",seriesIndex:0,dataIndex:0})},mouseover:function(e){var t=F.current.getEchartsInstance();0!==e.dataIndex&&t.dispatchAction({type:"downplay",seriesIndex:0,dataIndex:0})}}),A=Object(s.a)(N,1)[0];Object(a.useEffect)((function(){var e=F.current.getEchartsInstance();setTimeout((function(){e&&e.dispatchAction({type:"highlight",seriesIndex:[0],dataIndex:[0]})}),1e3)}),[]);var I=function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l-c>=0?S(l-c):v(),clearInterval(t),t=setInterval((function(){S((function(e){return e-n>=0?e-n:(clearInterval(t),v(),0)}))}),n);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=!0,t=[];if(j&&Object.keys(j).length>0){var n=Object.values(j).sort((function(e,t){return t.nextWeekWeight-e.nextWeekWeight})),a=Object(d.a)(100);n.map((function(n,c){Object(d.a)(n.nextWeekWeight).gt(0)&&(e=!1),c<9&&(a=a.minus(n.nextWeekWeight),t.push({value:n.nextWeekWeight,name:n.voteSymbol+([].concat(Object(r.a)(g.a.flexibleKeys),Object(r.a)(g.a.fixableKeys)).includes(n.keyName)?n.voteKey&&!g.a.flexibleKeys.includes(n.keyName)?"\uff08Fixed+Flexible\uff09":"\uff08Flexible\uff09":"")}))})),a.lt(0)&&(a=Object(d.a)(0)),t.push({value:Object(d.t)(a),name:u.a.get("governance.others")})}return{tooltip:{show:O,trigger:"item",formatter:"{b} : {c}%"},legend:{show:!1,top:"10%",left:"center"},series:[{type:"pie",height:O?230:255,top:O?20:0,radius:["50%","70%"],color:["#7243F4","#AD63FF","#4A94FF","#27C58B","#A7CF6B","#F7CE5A","#FF944A","#F68B9C","#FEB8D9","#F47171"],hoverAnimation:!1,avoidLabelOverlap:!0,stillShowZeroSum:e,minShowLabelAngle:.01,emphasis:{scale:!1,label:{position:"outside",show:!0,fontSize:O?"10":"12",fontWeight:"bold"}},label:{show:!0,position:"outside",formatter:!O&&"{b} {c}%",fontSize:O?"10":"12"},data:t}]}};return Object(w.jsx)(b.a,{children:function(){return Object(w.jsxs)("div",{className:"card-white mining-weight",children:[Object(w.jsxs)("h1",{className:"card-title",children:[u.a.get("governance.pool_weight"),Object(w.jsx)(y.a,{title:u.a.get("governance.pool_weight_tips"),trigger:["hover","click"],children:Object(w.jsx)(k.a,{style:{width:16,height:16}})})]}),Object(w.jsx)("p",{style:{textAlign:"center"},children:u.a.get("governance.effect_time",{value:l>0?new Date(parseInt(l)).format("yyyy-MM-dd h:m:s"):"xxxx-xx-xx xx:xx:xx"})}),Object(w.jsx)(_,{data:W}),Object(w.jsx)("div",{className:"lastest-vote-chart",children:Object(w.jsx)(f.a,{option:P(),className:"vote-weight-echarts",ref:F,onEvents:A,opts:{renderer:"svg"}})})]})}})},F=n(1736),N=function(e){var t=e.data,n=window.localStorage.getItem("lang"),a=function(){var e=[{key:0,name:"--",thisWeekWeight:"--",thisWeekApy:"--",nextWeekWeight:"--",nextWeekApy:"--"}];if(t&&Object.keys(t).length>0){e=Object.keys(t).sort((function(e,n){return t[e].index-t[n].index})).map((function(e,a){return{key:a,name:("USDC Old LP"===t[e].voteSymbol&&"zh-CN"===n?"Old USDC LP":t[e].voteSymbol)+([].concat(Object(r.a)(g.a.flexibleKeys),Object(r.a)(g.a.fixableKeys)).includes(t[e].keyName)?t[e].voteKey&&!g.a.flexibleKeys.includes(t[e].keyName)?"\uff08Fixed+Flexible\uff09":"\uff08Flexible\uff09":""),thisWeekWeight:Object(d.t)(t[e].thisWeekWeight,{miniText:.01})+"%",thisWeekApy:Object(d.s)(t[e].thisWeekApy,!1)+"%",nextWeekWeight:Object(d.t)(t[e].nextWeekWeight,{miniText:.01})+"%",nextWeekApy:Object(d.s)(t[e].nextWeekApy,!1)+"%"}}));var a=g.a.flexibleKeys.length,o=e.splice(e.length-a,a).sort((function(e,t){return e.key-t.key})),i=e.splice(e.length-3,3).sort((function(e,t){return t.key-e.key})),s=[{key:"other",name:u.a.get("farm.other"),thisWeekApy:Object(d.s)(0,!1)+"%",nextWeekApy:Object(d.s)(0,!1)+"%",nextWeekWeight:Object(d.t)(Object(d.B)(Object(c.a)(Object(c.a)({},t),{other:{}}),"nextWeekWeight").toFixed(2,1),{miniText:.01})+"%",thisWeekWeight:Object(d.t)(Object(d.B)(Object(c.a)(Object(c.a)({},t),{other:{}}),"thisWeekWeight").toFixed(2,1),{miniText:.01})+"%"}];e=[].concat(Object(r.a)(o),Object(r.a)(i),Object(r.a)(e),s)}return e};return Object(w.jsx)(b.a,{children:function(){return Object(w.jsxs)("div",{className:"card-white pool-apy",children:[Object(w.jsx)("h1",{className:"card-title",children:u.a.get("governance.pool_apy")}),Object(w.jsx)("div",{className:"pool-apy-table",children:Object(w.jsx)(F.a,{dataSource:a(),pagination:!1,size:"small",columns:[{title:function(){return Object(w.jsxs)(w.Fragment,{children:[u.a.get("governance.pool_name"),Object(w.jsx)(y.a,{title:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("p",{children:u.a.get("farm.text_42")}),Object(w.jsx)("p",{children:u.a.get("farm.text_43")})]}),trigger:["hover","click"],children:Object(w.jsx)(k.a,{style:{width:12,height:12}})})]})},dataIndex:"name",key:"name",width:200,fixed:"left"},{title:u.a.get("governance.currrent_weight"),dataIndex:"thisWeekWeight",key:"thisWeekWeight"},{title:function(){return Object(w.jsxs)(w.Fragment,{children:[u.a.get("governance.currrent_apy"),Object(w.jsx)(y.a,{title:u.a.get("farm.text_44"),trigger:["hover","click"],children:Object(w.jsx)(k.a,{style:{width:12,height:12}})})]})},dataIndex:"thisWeekApy",key:"thisWeekApy"},{title:function(){return Object(w.jsxs)(w.Fragment,{children:[u.a.get("governance.latest_weight"),Object(w.jsx)(y.a,{title:u.a.get("governance.latest_weight_tip"),trigger:["hover","click"],children:Object(w.jsx)(k.a,{style:{width:12,height:12}})})]})},dataIndex:"nextWeekWeight",key:"nextWeekWeight"},{title:function(){return Object(w.jsxs)(w.Fragment,{children:[u.a.get("governance.estimated_apy"),Object(w.jsx)(y.a,{title:u.a.get("farm.text_45"),trigger:["hover","click"],children:Object(w.jsx)(k.a,{style:{width:12,height:12}})})]})},dataIndex:"nextWeekApy",key:"nextWeekApy"}],scroll:{x:600},className:"pure-comp"})})]})}})},A=n(5),I=n(1707),P=n(1742),T=n(194),K=n(1706),C=n(27),V=n(993),D=n(61),E=I.a.Option,L=O.a.tokens,z=O.a.stakeKeys3,B=g.a.farmPoolKeys,M=g.a.farmPools,U=g.a.flexibleKeys,H=function(e){var t=e.voteData,n=e.formSubmit,l=e.getVoteState,j=e.checkUserVoteExpired,v=e.reset,h=t.votePower,g=window.localStorage.getItem("lang"),p=P.a.useForm(),m=Object(s.a)(p,1)[0],f=Object(a.useState)(Object(x.a)(window.navigator).any),W=Object(s.a)(f,1)[0],_=Object(a.useState)({}),S=Object(s.a)(_,2),N=S[0],H=S[1],q=[{title:u.a.get("governance.liquidity_pool"),dataIndex:"name",key:"name",width:100},{title:u.a.get("governance.percent"),dataIndex:"percent",key:"percent"},{title:u.a.get("governance.operate"),dataIndex:"operate",key:"operate",render:function(e){return e&&Object(w.jsx)("div",{children:N[e]&&N[e].status?Object(w.jsx)(y.a,{title:N[e].tips,trigger:["hover","click"],children:Object(w.jsx)(T.a,{size:"small",disabled:!0,children:u.a.get("governance.reset")})}):Object(w.jsx)(T.a,{size:"small",onClick:function(){v({poolType:e,votePercent:0})},children:u.a.get("governance.reset")})})}}];Object(a.useEffect)((function(){for(var e in h)e&&te(e)}),[h]);var J="",R=Object(a.useState)(!0),Y=Object(s.a)(R,2),Z=Y[0],G=Y[1],Q=function(e){n(e),Object(D.a)({action:D.e.vote,event_category:D.h.governance})},X=function(e){G(!0)},$=function(e){if(e.target&&"percent"===e.target.name){if(""===e.target.value)return void m.setFieldsValue({votePercent:""});var t=e.target.value;if(Object(d.a)(t).lte(100)){var n,a=t.split(".");(null===(n=a[1])||void 0===n?void 0:n.length)>2&&(t="".concat(a[0]+"."+a[1].substr(0,2))),ee(t)}else m.setFieldsValue({votePercent:J})}ne()},ee=function(e){if(e){var t=Object(d.T)(e,2),n=t.valid,a=t.str;if(n)J=a,m.setFieldsValue({votePercent:a});else{var c="";m.getFieldsValue().votePercent.length>1&&(c=J),m.setFieldsValue({votePercent:c})}}},te=function(){var e=Object(i.a)(Object(o.a)().mark((function e(n){var a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.currentVote||!t.currentVote.isEqualTo(0)){e.next=3;break}return H((function(e){return Object(c.a)(Object(c.a)({},e),{},Object(A.a)({},n,{status:!0,tips:u.a.get("governance.my_vote_tips4")}))})),e.abrupt("return",!1);case 3:return e.next=5,l(h[n].token);case 5:if(!(a=e.sent)){e.next=9;break}return H((function(e){return Object(c.a)(Object(c.a)({},e),{},Object(A.a)({},n,{status:a,tips:u.a.get("governance.my_vote_tips3")}))})),e.abrupt("return",!1);case 9:return e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){m.validateFields().then((function(e){G(!1)})).catch((function(e){G(!0)}))},ae=function(){var e=[{key:0,name:"--",percent:"--"}];return h&&Object.keys(h).length>0&&(e=Object.keys(h).map((function(e,t){return{key:t,name:"USDC Old LP"===h[e].voteSymbol&&"zh-CN"===g?"Old USDC LP":h[e].voteSymbol,percent:Object(d.t)(h[e].value,{miniText:.01})+"%",operate:e}}))),e},ce=function(){var n=Object(i.a)(Object(o.a)().mark((function n(a){var c,r,i;return Object(o.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=m.getFieldValue("poolType"),r=e.newFarmData,!c){n.next=8;break}return n.next=5,l(B.includes(c)?r[M[c].id].voteKey:L[c].token);case 5:if(!n.sent){n.next=8;break}return n.abrupt("return",Promise.reject(new Error(u.a.get("governance.my_vote_tips2"))));case 8:return n.next=10,j();case 10:if(!n.sent){n.next=13;break}return n.abrupt("return",Promise.reject(new Error(u.a.get("governance.my_vote_tips6"))));case 13:if(!t.currentVote.isEqualTo(0)){n.next=15;break}return n.abrupt("return",Promise.reject(new Error(u.a.get("governance.my_vote_tips4"))));case 15:if(i=+Object(d.a)(100).minus(t.userUsedPower).toString(),h&&-1!==Object.keys(h).indexOf(c)&&(i+=parseInt(h[c].value)),!(a&&a>i)){n.next=19;break}return n.abrupt("return",Promise.reject(new Error(u.a.get("governance.input_error_msg",{value:i}))));case 19:if(a){n.next=21;break}return n.abrupt("return",Promise.reject(new Error(u.a.get("governance.my_vote_tips5"))));case 21:return n.abrupt("return",Promise.resolve());case 22:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),re=function(){var e=z.map((function(e,t){return Object(w.jsxs)(E,{value:e,children:[Object(w.jsx)("div",{className:"combine-icon",children:Object(w.jsx)("img",{src:Object(C.e)(e,L[e].version),alt:"".concat(e," icon"),className:"token-logos"})}),"USDC Old LP"===L[e].voteSymbol&&"zh-CN"===g?"Old USDC LP":L[e].voteSymbol," ",O.a.voteKeys.includes(L[e].voteSymbol)?"\uff08Flexible\uff09":""]},t)})),t=B.map((function(e,t){var n=M[e].id;return Object(w.jsxs)(E,{value:e,children:[Object(w.jsx)("div",{className:"combine-icon",children:Object(w.jsx)("img",{src:Object(C.e)(n,L[n].version),alt:"".concat(n," icon"),className:"token-logos"})}),L[n].voteSymbol,U.includes(n)?"\uff08Flexible\uff09":"\uff08Fixed+Flexible\uff09"]},"00"+t)}));return[].concat(Object(r.a)(t),Object(r.a)(e))};return Object(w.jsx)(b.a,{children:function(){return Object(w.jsxs)("div",{className:"card-white card-white-center my-vote",children:[Object(w.jsxs)("h1",{className:"card-title",children:[u.a.get("governance.my_vote"),Object(w.jsx)(y.a,{title:u.a.getHTML("governance.my_vote_tips"),trigger:["hover","click"],children:Object(w.jsx)(k.a,{style:{width:13,height:13}})}),Object(w.jsx)("a",{className:"toLockSun",href:"/?lang=".concat(g,"#/stake?modalShow=LockModal"),children:u.a.get("governance.to_lock_sun")+" >>"})]}),Object(w.jsx)("div",{className:"vote-form",children:Object(w.jsxs)(P.a,{form:m,layout:W?"horizontal":"inline",name:"control-hooks",onFinish:Q,onFinishFailed:X,labelAlign:"right",requiredMark:!1,children:[Object(w.jsx)(P.a.Item,{name:"poolType",label:u.a.get("governance.choose_liquidity_pool")+":",colon:!1,rules:[{required:!0,message:u.a.get("governance.choose_pool")}],children:Object(w.jsx)(I.a,{className:"pool-selector pool-selector-new",placeholder:u.a.get("governance.choose_pool"),onChange:$,popupClassName:"gover-dropdown gover-dropdown-new",dropdownMatchSelectWidth:!1,placement:"bottomRight",dropdownAlign:{overflow:{adjustY:0}},suffixIcon:Object(w.jsx)("img",{src:V.a}),children:re()})}),Object(w.jsx)(P.a.Item,{name:"votePercent",label:u.a.get("governance.input_percent")+":",colon:!1,rules:[{validator:function(e,t){return ce(t)}}],children:Object(w.jsx)(K.a,{placeholder:u.a.get("governance.input_number"),name:"percent",autoComplete:"off",suffix:"%",onChange:$})}),Object(w.jsxs)(P.a.Item,{children:[Object(w.jsxs)("p",{className:"vote-info",children:[Object(w.jsxs)("span",{children:[u.a.get("governance.current_votes"),":",Object(w.jsx)("i",{children:Object(d.t)(t.currentVote)})]}),Object(w.jsxs)("span",{children:[u.a.get("governance.votes_used"),":",Object(w.jsxs)("i",{children:[Object(d.t)(t.userUsedPower,{miniText:.01}),"%"]})]})]}),Object(w.jsx)(T.a,{className:"vote-btn",type:"primary",htmlType:"submit",disabled:Z,children:u.a.get("governance.vote")})]})]})}),h&&Object.keys(h).length>0&&Object(w.jsx)("div",{className:"vote-table",children:Object(w.jsx)(F.a,{dataSource:ae(),pagination:!1,size:"small",columns:q})})]})}})},q=O.a.defaultVotePrecision,J=O.a.tokens,R=(g.a.farmPoolKeys,g.a.farmPools),Y=g.a.flexibleKeys,Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:+new Date;return new Date(e+288e5).toJSON().substr(0,19).replace("T"," ")},G=function(e){var t=e.data,n=[{title:u.a.get("governance.vote_time"),dataIndex:"eventTime",key:"eventTime"},{title:u.a.get("governance.vote_amount"),dataIndex:"vote_amount",key:"vote_amount"},{title:u.a.get("governance.vote_pool"),dataIndex:"vote_pool",key:"vote_pool"},{title:u.a.get("governance.vote_percent"),dataIndex:"weights",key:"weights"}],a=function(){try{var e=[{key:0,eventTime:"--",vote_amount:"--",vote_pool:"--",weights:"--"}];if(t&&t.length>0)e=t.sort((function(e,t){return t.eventTime-e.eventTime})).map((function(e,t){var n,a,c,r=Object(d.r)(J,e.votetoAddress,"token"),o=Object(d.r)(R,e.voteKey,"lpStaker"),i=Y.includes(null===(n=R[o])||void 0===n?void 0:n.id)?"\uff08Flexible\uff09":"\uff08Fixed+Flexible\uff09",s=(null===(a=J[null===(c=R[o])||void 0===c?void 0:c.id])||void 0===a?void 0:a.voteSymbol)||"";return{key:t,eventTime:Z(e.eventTime),vote_amount:Object(d.t)(Object(d.a)(e.tokensVote).div(q),{miniText:"0.01"}),vote_pool:e.voteKey?s+i:r?J[r].voteSymbol+(O.a.voteKeys.includes(J[r].voteSymbol)?"\uff08Flexible\uff09":""):"--",weights:Object(d.t)(Object(d.a)(e.weights).div(100),{percent:!0,miniText:"0.01"})+"%"}}));return e}catch(n){console.log("getTableData error:",n)}};return Object(w.jsx)(b.a,{children:function(){return Object(w.jsxs)("div",{className:"card-white card-white-center vote-record",children:[Object(w.jsx)("h1",{className:"card-title",children:u.a.get("governance.record_title")}),Object(w.jsx)("div",{className:"record-table",children:Object(w.jsx)(F.a,{dataSource:a(),pagination:{position:["bottomCenter"]},size:"small",columns:n,locale:{emptyText:u.a.get("governance.empty_text")},scroll:{x:470}})})]})}})},Q=n(936),X=O.a.tokens,$=O.a.defaultVotePrecision,ee=O.a.stakeKeys3,te=g.a.farmPoolKeys,ne=g.a.farmPools,ae=g.a.flexibleKeys,ce=864e3;function re(){var e=Object(b.d)((function(){return j.a.network})),t=Object(b.d)((function(){return j.a.system})),n=(Object(b.d)((function(){return j.a.farmStore})),604800),l={},g=Object(a.useState)(0),x=Object(s.a)(g,2),m=x[0],f=x[1],y=Object(a.useState)(0),k=Object(s.a)(y,2),W=k[0],_=k[1],F=Object(a.useState)(0),A=Object(s.a)(F,2),I=A[0],P=A[1],T=Object(a.useState)(0),K=Object(s.a)(T,2),C=K[0],V=K[1],D=Object(a.useState)({}),E=Object(s.a)(D,2),L=E[0],z=E[1],B=Object(a.useState)({}),M=Object(s.a)(B,2),U=M[0],q=M[1],J=Object(a.useState)({}),R=Object(s.a)(J,2),Y=R[0],Z=R[1],re=Object(a.useState)({}),oe=Object(s.a)(re,2),ie=oe[0],se=oe[1],le=Object(a.useState)([]),ue=Object(s.a)(le,2),be=(ue[0],ue[1]);Object(a.useEffect)((function(){var t=setInterval((function(){Oe(),e.isConnected&&he()}),e.defaultIntervalSec);return function(){clearInterval(t)}}),[]);var je=function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ve(),Oe();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:he();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.v)();case 2:(t=e.sent).success?f(t.time):setTimeout((function(){ve()}),5e3),n=fe(m),V(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){var t=Object(i.a)(Object(o.a)().mark((function t(){var n,a,c;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(v.F)(e.defaultAccount);case 3:return(n=t.sent).success&&Z(n.data.logList),a=ge(),c=pe(n.data.logList),t.next=9,a;case 9:return t.next=11,c;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(){return t.apply(this,arguments)}}(),Oe=function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,n,a,c,i,s;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={},ee.map((function(e){t[e]={}})),e.next=5,Object(v.e)();case 5:n=e.sent,a={},c=[],[],n.success&&n.data&&(_(Object(d.a)(n.data.totalVe).div($).toFixed(2,1)),P(Object(d.a)(n.data.totalVote).div($).toFixed(2,1)),n.data.list&&n.data.list.length>0&&(i=n.data.list.length,s=[].concat(Object(r.a)(ae),Object(r.a)(ee)),n.data.list.map((function(e){var n=Object(d.r)(X,e.name,"token");e.voteKey&&(n=Object(d.r)(ne,e.name,"token")),"twopoollpNew_v1"===n&&(n="twopoollpNew"),"usddusdt_v1"===n&&(n="usddusdt"),n&&-1!==s.indexOf(n)&&(e.voteKey?(a[n]={voteKey:e.voteKey},c.push(e.voteKey),t[e.voteKey]={index:i++,keyName:n,symbol:X[n].symbol,voteSymbol:X[n].voteSymbol,nextWeekApy:Object(d.a)(e.nextWeekApyVote).times(100).toFixed(2,1),nextWeekWeight:Object(d.a)(e.nextWeekWeight).div(1e16).toFixed(2,1),thisWeekApy:Object(d.a)(e.thisWeekApyVote).times(100).toFixed(2,1),thisWeekWeight:Object(d.a)(e.thisWeekWeight).div(1e16).toFixed(2,1),voteKey:e.voteKey}):t[n]={index:s.indexOf(n),keyName:n,symbol:X[n].symbol,voteSymbol:X[n].voteSymbol,nextWeekApy:Object(d.a)(e.nextWeekApyVote).times(100).toFixed(2,1),nextWeekWeight:Object(d.a)(e.nextWeekWeight).div(1e16).toFixed(2,1),thisWeekApy:Object(d.a)(e.thisWeekApyVote).times(100).toFixed(2,1),thisWeekWeight:Object(d.a)(e.thisWeekWeight).div(1e16).toFixed(2,1)})})),se(a),be(c),Object.keys(t).map((function(e,n){n!==Object.keys(t).length-1||c.includes(e)||(Object(d.a)(t[e].nextWeekWeight).gt(0)&&(t[e].nextWeekWeight=Object(d.B)(t,"nextWeekWeight").toFixed(2,1)),Object(d.a)(t[e].thisWeekWeight).gt(0)&&(t[e].thisWeekWeight=Object(d.B)(t,"thisWeekWeight").toFixed(2,1)))})),z(t))),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),ge=function(){var t=Object(i.a)(Object(o.a)().mark((function t(){var n;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.nb)("0x0000000000000000000000".concat(d.fb.address.toHex(e.defaultAccount)));case 2:n=t.sent,q((function(e){return Object(c.a)(Object(c.a)({},e),{},{currentVote:n.value})}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),pe=function(){var t=Object(i.a)(Object(o.a)().mark((function t(n){var a,r,i,s,l,u;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a={},r=Object(d.a)(0),i=[],s=[],l={},n&&n.map((function(e){l[e.votetoAddress]=e})),!((s=Object.keys(l)).length>0)){t.next=13;break}return t.next=11,Object(h.xb)(e.defaultAccount,s);case 11:(u=t.sent).success&&(r=u.values[0],i=u.values.slice(1),s.map((function(e,t){if(l[e].voteKey){var n="",c="",r="";Object.keys(ne).map((function(t){ne[t].lpStaker===l[e].voteKey&&(n=X[ne[t].id].symbol,c=X[ne[t].id].voteSymbol,r=ne[t].id)}));var o=ae.includes(r)?"\uff08Flexible\uff09":"\uff08Fixed+Flexible\uff09";a[e]={symbol:n,voteSymbol:c+o,token:e,value:i[t]}}else{var s=Object(d.r)(X,e,"token")||"--",u=Object(d.r)(X,e,"token")?X[s].symbol:"--",b=Object(d.r)(X,e,"token")?X[s].voteSymbol:"--";a[s]={symbol:u,voteSymbol:b+(O.a.voteKeys.includes(b)?"\uff08Flexible\uff09":""),token:e,value:i[t]}}})));case 13:q((function(e){return Object(c.a)(Object(c.a)({},e),{},{userUsedPower:r,votePower:a})})),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.log(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e){return t.apply(this,arguments)}}(),xe=function(){var t=Object(i.a)(Object(o.a)().mark((function t(n){var a,c;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(h.ob)(e.defaultAccount,n);case 2:if(!(a=t.sent).success){t.next=7;break}if(!((c=a.value.toNumber())>=0&&c+ce<m/1e3)){t.next=7;break}return t.abrupt("return",!1);case 7:return t.abrupt("return",!0);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),me=function(){var t=Object(i.a)(Object(o.a)().mark((function t(){var n,a;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===l.state){t.next=2;break}return t.abrupt("return",l.state);case 2:return t.next=4,Object(h.pb)("0x0000000000000000000000".concat(d.fb.address.toHex(e.defaultAccount)));case 4:return(n=t.sent).success&&(a=n.value.times(1e3).toNumber(),l.state=C>a&&0!==a),t.abrupt("return",l.state);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),fe=function(e){return(parseInt(e/n/1e3)+1)*n*1e3},ye=function(){var e=Object(i.a)(Object(o.a)().mark((function e(n){var a,c,r,i,s;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=te.includes(n.poolType),c=a?ne[n.poolType].id:n.poolType,e.prev=2,r={title:"actions.vote_for_gauge_weights",obj:{percent:"".concat(Object(d.t)(n.votePercent),"%"),pool:X[c].symbol}},i=a?ie[c].voteKey:X[c].token,s=Object(d.a)(n.votePercent).times(100)._toIntegerDown()._toHex(),e.next=8,t.voteLPPool(s,"0x0000000000000000000000".concat(d.fb.address.toHex(i)),r);case 8:e.sent&&setTimeout((function(){Oe(),he()}),5e3),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}(),ke=function(){var e=Object(i.a)(Object(o.a)().mark((function e(n){var a,c,r,i,s,l;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object.values(ne).filter((function(e){return e.lpStaker===n.poolType}))[0],r=(c=!!a)?a.lpStaker:n.poolType,i={title:"actions.vote_for_gauge_weights",obj:{percent:"".concat(Object(d.t)(n.votePercent),"%"),pool:c?a.symbol:X[r].symbol}},s=c?a.lpStaker:X[r].token,l=Object(d.a)(n.votePercent).times(100)._toIntegerDown()._toHex(),e.next=9,t.voteLPPool(l,"0x0000000000000000000000".concat(d.fb.address.toHex(s)),i);case 9:e.sent&&setTimeout((function(){Oe(),he()}),5e3),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),we=Object(a.useMemo)((function(){return{showBack:!0,onBack:function(){Object(Q.h)({id:"more"})}}}),[]);return Object(w.jsx)(b.a,{children:function(){return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(p.a,{routeName:"governance",instantActions:je,mountedActions:de,mShowLogo:!1,mShowBottomNav:!1,subNavProps:we}),Object(w.jsxs)("div",{className:"main-page-content",children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"gradient-title",children:u.a.get("governance.main_title")}),Object(w.jsx)("div",{className:"dim-content",children:u.a.get("governance.sub_title")})]})," ",Object(w.jsxs)("div",{id:"governance",children:[Object(w.jsx)(S,{miningWeight:L,serverTime:m,nextTime:C,resetCountDown:function(){ve(),Oe(),e.isConnected&&he()}}),Object(w.jsx)(N,{data:L}),Object(w.jsxs)("div",{className:"card-white vote-info",children:[Object(w.jsx)("h1",{className:"card-title",children:u.a.get("governance.votes_data")}),Object(w.jsxs)("div",{className:"vote-info-detail",children:[Object(w.jsxs)("p",{children:[Object(w.jsx)("span",{children:u.a.get("governance.total_vote")}),Object(w.jsx)("span",{children:Object(d.t)(W)})]}),Object(w.jsxs)("p",{children:[Object(w.jsx)("span",{children:u.a.get("governance.total_ve")}),Object(w.jsx)("span",{children:Object(d.t)(I)})]})]})]}),e.isConnected&&Object(w.jsx)(H,{voteData:U,getVoteState:xe,checkUserVoteExpired:me,formSubmit:ye,reset:ke,newFarmData:ie}),e.isConnected&&Y.length>0&&Object(w.jsx)(G,{data:Y})]})]})]})}})}function oe(){return Object(w.jsx)(re,{})}},993:function(e,t,n){"use strict";t.a=n.p+"static/media/gray-drop.cdc278f0.svg"}}]);